CLEAR="\033[0m"
ORANGE="\033[33m"

set -e

successfully() {
  $* || (echo "failed" 1>&2 && exit 1)
}

fancy_echo() {
  echo -e ${ORANGE}$1${CLEAR}
  echo
}

pacman_noconfirm() {
  sudo pacman --noconfirm "$@"
}

USER=`whoami`
CURRENTSHELL=`grep $USER /etc/passwd|cut -d : -f 7`

fancy_echo "Updating system packages ..."
  successfully pacman_noconfirm -Syu

echo "Curent shell: $CURRENTSHELL"
if [ "$CURRENTSHELL" != "/bin/zsh" ];
  then
    fancy_echo "Installing zsh ..."
      successfully pacman_noconfirm -S zsh

    fancy_echo "Changing your shell to zsh ..."
      successfully chsh -s `which zsh`

    fancy_echo "Your shell will now restart to apply changes."
      exec `which zsh` -l
else
  fancy_echo "You're already running zsh. Good job, buddy!"
fi
